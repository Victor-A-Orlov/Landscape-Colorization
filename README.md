# Landscape Colorization

## Motivation

There is an approach to making digital painting landscapes where you do a grayscale image first and then color it using different blend modes in your graphics editor. But it appears that I am really bad at coloring my grayscale sketches and find the process rather tedious. So I thought, what if we had a model that does the coloring automatically based on the dataset of different existing paintings.



## Approach

Basically, I used the approach described in ["Colorizing black & white images with U-Net and conditional GAN — A Tutorial"](https://towardsdatascience.com/colorizing-black-white-images-with-u-net-and-conditional-gan-a-tutorial-81b2df111cd8) but with TensorFlow.

We use a pre-trained classification model (ResNet18 in my case), then use it as a backbone for U-Net (or similar pix2pix architecture) model, then train U-Net on our dataset, then use the trained U-Net as a generator part of conditional GAN and finally train the whole сGAN on our dataset.



## Results

### Good ones

![This is an image](https://www.kaggleusercontent.com/kf/85258695/eyJhbGciOiJkaXIiLCJlbmMiOiJBMTI4Q0JDLUhTMjU2In0..8LcWOos7_zrF3l-HEyOn-A.P9k81e5ck6ThM0WV4QJU-D6vybRl5g5Y0unRTH5DbCudoIqsyQaIFW24wqpaPNdwm8O9ZzAmYfZW4k4AMe5J-pwyyUNClawoYD70MBFO1ob-_uSjbiW6iey7vpMBkS_7zCLic3mD4AR-95ghmrYuk8L7-WdPq63XUq3hWwgQNxtUf43VeAoMB3RBdbcYeBV6063xljBt49-6Q-jE01NKeKtEafOxtgPPJSjBxA4VnhjEwiXZuBCdb_46qJ6P9TLYwPMBHjTrDsiqn-bQDu08lgcsPJJmelIGfDOIpDesbTPHq9df6-bZaQr7mihrfn4szdn6GlLcwEtlZyYGgH_tivYw2-k8GcJWZmjrwxrnhY8eyoaH0LYL70DUHknR-SU9zhP9lGiBP4fIh1Ik2K-d634SGeTUH2uHA9G8BCR8dwax9i4EK_QEN7Ku_EXR4Yl0uJ8aqhbAHbF2a6jxrHQXuvgHCfqlkPUVnWjpskYJe9mSKaYr5RRPjV3edowD3K_tD7e88WEplQ1zHu8dTAYlK4kJ5bPRbaF6GxALfuugZBZoF1IdoQuPKfZqgSGtvUN8lcLVj8UM9PPhbD8UQRv2rmmPjPKWCw-X9dhjQ1DLvJOqwuiyKOsH1rZP3EiBcE-5Qbl3KyMh3J9lLM_QNSc7MU4fwONXedDITpjRMtLovW5rjlDHY41EaaQ2Mfv-hQYk.FtCcikRzVDPhHRQg7HZfOQ/__results___files/__results___52_13.png)
![This is an image](https://www.kaggleusercontent.com/kf/85258695/eyJhbGciOiJkaXIiLCJlbmMiOiJBMTI4Q0JDLUhTMjU2In0..8LcWOos7_zrF3l-HEyOn-A.P9k81e5ck6ThM0WV4QJU-D6vybRl5g5Y0unRTH5DbCudoIqsyQaIFW24wqpaPNdwm8O9ZzAmYfZW4k4AMe5J-pwyyUNClawoYD70MBFO1ob-_uSjbiW6iey7vpMBkS_7zCLic3mD4AR-95ghmrYuk8L7-WdPq63XUq3hWwgQNxtUf43VeAoMB3RBdbcYeBV6063xljBt49-6Q-jE01NKeKtEafOxtgPPJSjBxA4VnhjEwiXZuBCdb_46qJ6P9TLYwPMBHjTrDsiqn-bQDu08lgcsPJJmelIGfDOIpDesbTPHq9df6-bZaQr7mihrfn4szdn6GlLcwEtlZyYGgH_tivYw2-k8GcJWZmjrwxrnhY8eyoaH0LYL70DUHknR-SU9zhP9lGiBP4fIh1Ik2K-d634SGeTUH2uHA9G8BCR8dwax9i4EK_QEN7Ku_EXR4Yl0uJ8aqhbAHbF2a6jxrHQXuvgHCfqlkPUVnWjpskYJe9mSKaYr5RRPjV3edowD3K_tD7e88WEplQ1zHu8dTAYlK4kJ5bPRbaF6GxALfuugZBZoF1IdoQuPKfZqgSGtvUN8lcLVj8UM9PPhbD8UQRv2rmmPjPKWCw-X9dhjQ1DLvJOqwuiyKOsH1rZP3EiBcE-5Qbl3KyMh3J9lLM_QNSc7MU4fwONXedDITpjRMtLovW5rjlDHY41EaaQ2Mfv-hQYk.FtCcikRzVDPhHRQg7HZfOQ/__results___files/__results___52_95.png)
![This is an image](https://www.kaggleusercontent.com/kf/85258695/eyJhbGciOiJkaXIiLCJlbmMiOiJBMTI4Q0JDLUhTMjU2In0..8LcWOos7_zrF3l-HEyOn-A.P9k81e5ck6ThM0WV4QJU-D6vybRl5g5Y0unRTH5DbCudoIqsyQaIFW24wqpaPNdwm8O9ZzAmYfZW4k4AMe5J-pwyyUNClawoYD70MBFO1ob-_uSjbiW6iey7vpMBkS_7zCLic3mD4AR-95ghmrYuk8L7-WdPq63XUq3hWwgQNxtUf43VeAoMB3RBdbcYeBV6063xljBt49-6Q-jE01NKeKtEafOxtgPPJSjBxA4VnhjEwiXZuBCdb_46qJ6P9TLYwPMBHjTrDsiqn-bQDu08lgcsPJJmelIGfDOIpDesbTPHq9df6-bZaQr7mihrfn4szdn6GlLcwEtlZyYGgH_tivYw2-k8GcJWZmjrwxrnhY8eyoaH0LYL70DUHknR-SU9zhP9lGiBP4fIh1Ik2K-d634SGeTUH2uHA9G8BCR8dwax9i4EK_QEN7Ku_EXR4Yl0uJ8aqhbAHbF2a6jxrHQXuvgHCfqlkPUVnWjpskYJe9mSKaYr5RRPjV3edowD3K_tD7e88WEplQ1zHu8dTAYlK4kJ5bPRbaF6GxALfuugZBZoF1IdoQuPKfZqgSGtvUN8lcLVj8UM9PPhbD8UQRv2rmmPjPKWCw-X9dhjQ1DLvJOqwuiyKOsH1rZP3EiBcE-5Qbl3KyMh3J9lLM_QNSc7MU4fwONXedDITpjRMtLovW5rjlDHY41EaaQ2Mfv-hQYk.FtCcikRzVDPhHRQg7HZfOQ/__results___files/__results___52_66.png)
### Not-So-Good ones
![This is an image](https://www.kaggleusercontent.com/kf/85258695/eyJhbGciOiJkaXIiLCJlbmMiOiJBMTI4Q0JDLUhTMjU2In0..8LcWOos7_zrF3l-HEyOn-A.P9k81e5ck6ThM0WV4QJU-D6vybRl5g5Y0unRTH5DbCudoIqsyQaIFW24wqpaPNdwm8O9ZzAmYfZW4k4AMe5J-pwyyUNClawoYD70MBFO1ob-_uSjbiW6iey7vpMBkS_7zCLic3mD4AR-95ghmrYuk8L7-WdPq63XUq3hWwgQNxtUf43VeAoMB3RBdbcYeBV6063xljBt49-6Q-jE01NKeKtEafOxtgPPJSjBxA4VnhjEwiXZuBCdb_46qJ6P9TLYwPMBHjTrDsiqn-bQDu08lgcsPJJmelIGfDOIpDesbTPHq9df6-bZaQr7mihrfn4szdn6GlLcwEtlZyYGgH_tivYw2-k8GcJWZmjrwxrnhY8eyoaH0LYL70DUHknR-SU9zhP9lGiBP4fIh1Ik2K-d634SGeTUH2uHA9G8BCR8dwax9i4EK_QEN7Ku_EXR4Yl0uJ8aqhbAHbF2a6jxrHQXuvgHCfqlkPUVnWjpskYJe9mSKaYr5RRPjV3edowD3K_tD7e88WEplQ1zHu8dTAYlK4kJ5bPRbaF6GxALfuugZBZoF1IdoQuPKfZqgSGtvUN8lcLVj8UM9PPhbD8UQRv2rmmPjPKWCw-X9dhjQ1DLvJOqwuiyKOsH1rZP3EiBcE-5Qbl3KyMh3J9lLM_QNSc7MU4fwONXedDITpjRMtLovW5rjlDHY41EaaQ2Mfv-hQYk.FtCcikRzVDPhHRQg7HZfOQ/__results___files/__results___52_91.png)
![This is an image](https://www.kaggleusercontent.com/kf/85258695/eyJhbGciOiJkaXIiLCJlbmMiOiJBMTI4Q0JDLUhTMjU2In0..8LcWOos7_zrF3l-HEyOn-A.P9k81e5ck6ThM0WV4QJU-D6vybRl5g5Y0unRTH5DbCudoIqsyQaIFW24wqpaPNdwm8O9ZzAmYfZW4k4AMe5J-pwyyUNClawoYD70MBFO1ob-_uSjbiW6iey7vpMBkS_7zCLic3mD4AR-95ghmrYuk8L7-WdPq63XUq3hWwgQNxtUf43VeAoMB3RBdbcYeBV6063xljBt49-6Q-jE01NKeKtEafOxtgPPJSjBxA4VnhjEwiXZuBCdb_46qJ6P9TLYwPMBHjTrDsiqn-bQDu08lgcsPJJmelIGfDOIpDesbTPHq9df6-bZaQr7mihrfn4szdn6GlLcwEtlZyYGgH_tivYw2-k8GcJWZmjrwxrnhY8eyoaH0LYL70DUHknR-SU9zhP9lGiBP4fIh1Ik2K-d634SGeTUH2uHA9G8BCR8dwax9i4EK_QEN7Ku_EXR4Yl0uJ8aqhbAHbF2a6jxrHQXuvgHCfqlkPUVnWjpskYJe9mSKaYr5RRPjV3edowD3K_tD7e88WEplQ1zHu8dTAYlK4kJ5bPRbaF6GxALfuugZBZoF1IdoQuPKfZqgSGtvUN8lcLVj8UM9PPhbD8UQRv2rmmPjPKWCw-X9dhjQ1DLvJOqwuiyKOsH1rZP3EiBcE-5Qbl3KyMh3J9lLM_QNSc7MU4fwONXedDITpjRMtLovW5rjlDHY41EaaQ2Mfv-hQYk.FtCcikRzVDPhHRQg7HZfOQ/__results___files/__results___52_35.png)
![This is an image](https://www.kaggleusercontent.com/kf/85258695/eyJhbGciOiJkaXIiLCJlbmMiOiJBMTI4Q0JDLUhTMjU2In0..8LcWOos7_zrF3l-HEyOn-A.P9k81e5ck6ThM0WV4QJU-D6vybRl5g5Y0unRTH5DbCudoIqsyQaIFW24wqpaPNdwm8O9ZzAmYfZW4k4AMe5J-pwyyUNClawoYD70MBFO1ob-_uSjbiW6iey7vpMBkS_7zCLic3mD4AR-95ghmrYuk8L7-WdPq63XUq3hWwgQNxtUf43VeAoMB3RBdbcYeBV6063xljBt49-6Q-jE01NKeKtEafOxtgPPJSjBxA4VnhjEwiXZuBCdb_46qJ6P9TLYwPMBHjTrDsiqn-bQDu08lgcsPJJmelIGfDOIpDesbTPHq9df6-bZaQr7mihrfn4szdn6GlLcwEtlZyYGgH_tivYw2-k8GcJWZmjrwxrnhY8eyoaH0LYL70DUHknR-SU9zhP9lGiBP4fIh1Ik2K-d634SGeTUH2uHA9G8BCR8dwax9i4EK_QEN7Ku_EXR4Yl0uJ8aqhbAHbF2a6jxrHQXuvgHCfqlkPUVnWjpskYJe9mSKaYr5RRPjV3edowD3K_tD7e88WEplQ1zHu8dTAYlK4kJ5bPRbaF6GxALfuugZBZoF1IdoQuPKfZqgSGtvUN8lcLVj8UM9PPhbD8UQRv2rmmPjPKWCw-X9dhjQ1DLvJOqwuiyKOsH1rZP3EiBcE-5Qbl3KyMh3J9lLM_QNSc7MU4fwONXedDITpjRMtLovW5rjlDHY41EaaQ2Mfv-hQYk.FtCcikRzVDPhHRQg7HZfOQ/__results___files/__results___52_25.png)

As we can see, the model do well with one specific sort of composition end environment but struggles with anything more unusual.

